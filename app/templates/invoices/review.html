{% extends "base.html" %}

{% block title %}Revisione Import - {{ invoice.supplier.name if invoice.supplier else "Fattura" }}{% endblock %}

{% block content %}
<div class="container-fluid vh-100 d-flex flex-column overflow-hidden">
    <div class="row bg-dark text-white py-3 px-4 align-items-center">
        <div class="col">
            <h1 class="h4 mb-1">Revisione Import</h1>
            <p class="mb-0 small text-white-50">
                Fornitore: {{ invoice.supplier.name if invoice.supplier else "N/D" }}
            </p>
        </div>
        <div class="col-auto text-end">
            <span class="badge bg-secondary">{{ invoice.invoice_number }}</span>
        </div>
    </div>

    <div class="row flex-fill g-0" style="min-height: 0;">
        <div class="col-12 col-lg-5 col-xl-4 border-end h-100 overflow-auto">
            <div class="p-4">
                <form method="POST" action="{{ url_for('invoices.review_loop_invoice_view', invoice_id=invoice.id) }}" class="d-flex flex-column h-100">
                    <div class="mb-3">
                        <label for="number" class="form-label">Numero Fattura</label>
                        <input type="text" class="form-control" id="number" name="number" value="{{ invoice.invoice_number }}" required>
                    </div>

                    <div class="mb-3">
                        <label for="date" class="form-label">Data</label>
                        <input type="date" class="form-control" id="date" name="date" value="{{ invoice.invoice_date.strftime('%Y-%m-%d') if invoice.invoice_date }}" required>
                    </div>

                    <div class="mb-4">
                        <label for="total_amount" class="form-label">Importo Totale</label>
                        <input type="number" step="0.01" class="form-control" id="total_amount" name="total_amount" value="{{ invoice.total_gross_amount }}">
                    </div>

                    <div class="mt-auto">
                        <button type="submit" class="btn btn-primary btn-lg w-100 mb-3">Conferma &amp; Prossima</button>
                        <a class="btn btn-outline-secondary w-100" href="{{ url_for('invoices.review_loop_redirect_view') }}">Salta</a>
                    </div>
                </form>
            </div>
        </div>

        <div class="col-12 col-lg-7 col-xl-8 h-100" style="min-height: 0;">
            <iframe src="{{ url_for('invoices.preview_invoice_visual', invoice_id=invoice.id) }}" class="w-100 h-100 border-0" title="Anteprima fattura"></iframe>
        </div>
    </div>
</div>
{% endblock %}
